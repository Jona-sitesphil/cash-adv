<div class="wrapper" [ngClass]="{ 'sidebar-open': isSidebarOpen }">
  <!-- If you need the dashboard stats section, uncomment these lines:
  <div class="dashboard-container">
    <div class="stats-container">
      <div class="stats-box" *ngFor="let data of jonadata">
        <p class="stats-number">{{ data.count }}</p>
        <p class="stats-text">{{ data.label }}</p>
      </div>
    </div>
  </div>
  -->

  <div class="parent-container">
    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Employee</th>
            <th>Request Date</th>
            <th>Date Needed</th>
            <th>Amount</th>
            <th>Purpose</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of requests">
            <td>{{ item.userName }}</td>
            <td>{{ item.requestDate | date: 'medium' }}</td>
            <td>{{ item.neededDate | date: 'mediumDate' }}</td>
            <td>{{ item.amount | currency:'PHP':'symbol' }}</td>
            <td>{{ item.reason }}</td>
            <td>
              <button
                class="btn-approve"
                mat-button
                (click)="openApproveModal(item.userName, item.amount)"
              >
                Approve
              </button>
              <button
                class="btn-reject"
                mat-button
                (click)="openRejectModal(item.userName, item.amount)"
              >
                Reject
              </button>
              <button
                class="btn-details"
                mat-button
                (click)="openViewDetailsModal(item.userName)"
              >
                View Details
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Approve Modal -->
    <app-approve-modal
      *ngIf="isApproveModalOpen"
      [showModal]="isApproveModalOpen"
      [employeeName]="selectedEmployee"
      [amountRequested]="selectedAmount"
      [deductionStartDate]="deductionStartDate"
      [monthlyDeductionAmount]="monthlyDeductionAmount"
      [numberOfInstallments]="numberOfInstallments"
      [paymentSchedule]="selectedPaymentSchedule"
      (modalClosed)="closeApproveModal()"
      (approvalConfirmed)="handleApproval()"
    ></app-approve-modal>

    <!-- Reject Modal -->
    <app-reject-request-modal
      *ngIf="isRejectModalOpen"
      [data]="{ employee: selectedEmployee, amount: selectedAmount }"
      (modalClosed)="closeRejectModal()"
      (rejectionConfirmed)="handleRejection($event)"
    ></app-reject-request-modal>

    <!-- Payment Schedule Modal -->
    <app-payment-schedule
      *ngIf="isViewDetailsModalOpen"
      [employeeName]="selectedEmployee"
      [paymentSchedule]="selectedPaymentSchedule"
      (closeModalEvent)="closeViewDetailsModal()"
    ></app-payment-schedule>
  </div>
</div>
